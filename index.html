<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta content="ie=edge" http-equiv="x-ua-compatible">

  <title>Google Excel Sheet Storage to HTML {{@YO}}</title>

  <meta content="Google Excel Sheet Storage to HTML {{@YP}}" name="description">
  <meta content="width=device-width, initial-scale=1" name="viewport">

  <!-- Css -->
  <link href="css/main.css" rel="stylesheet">

  <!-- BS CSS CDN -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <!-- BS JS CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
  
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

  <!-- IMPORTANT PART -->
  <script src="https://www.google.com/jsapi" type="text/javascript"></script>

  <!-- Add ChartJS CDN -->
 <!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script> -->

</head>

<body id="background">

  <div id="box">
    <h1>{{ Google Sheets Storage }}</h1>

    <script src="js/google-sheets-html.js" type="text/javascript"></script>

    <div id="table" class="table table-striped bg-dark">
    </div>

    <p class="small">{{@Y.O}}</p>
  </div>

<!-- ---------------------------------------------- -->
<!-- PART 2: CHART JS -->

<div class="container text-center my-4">

  <p class="font-weight-bold">The data in the table comes from the google spreadsheet</p>

  <a class="btn btn-primary mb-4" href="https://docs.google.com/spreadsheets/d/17t52XqmKkfo8js1gVzy2penw71c6jBAklofqDydMzg0/edit?usp=sharing" role="button" target="_blank">Click to see the source sheet</a>

  <!-- Table  -->
  <table class="table table-bordered table-striped" id="testTable">
    <!-- Table head -->
    <thead>
      <tr>
        <th>Date</th>
        <th>Name</th>
        <th>Message</th>
        <th>Note</th>
      </tr>
    </thead>
    <!-- Table head -->

    <!-- Table body -->
    <tbody id="Yotable">

    
    </tbody>
    <!-- Table body -->
  </table>
  <!-- Table  -->

</div>

<div class="container">

  <!-- We use canvas element to draw graphics on web page. HTML 5 element -->
  <canvas id="bar-chart" width="800" height="450"></canvas>
  
</div>

 



<script>    
$.getJSON("https://spreadsheets.google.com/feeds/list/17t52XqmKkfo8js1gVzy2penw71c6jBAklofqDydMzg0/od6/public/values?alt=json", function (data) {

      var sheetData = data.feed.entry;

      var i;
      for (i = 0; i < sheetData.length; i++) {

      var Date = data.feed.entry[i]['gsx$timestamp']['$t'];
      var Name = data.feed.entry[i]['gsx$name']['$t'];
      var Message = data.feed.entry[i]['gsx$message']['$t'];
      var Note = data.feed.entry[i]['gsx$note']['$t'];

      document.getElementById('Yotable').innerHTML += ('<tr>'+'<td>'+Date+'</td>'+'<td>'+Name+'</td>'+'<td>'+Message+'</td>'+'<td>'+Note+'</td>'+'</tr>');

      }
    });
</script>




</body>
</html>
